/*!
 * name: @feizheng/next-weibo-oss
 * description: Weibo oss for next api.
 * url: https://github.com/afeiship/next-weibo-oss
 * version: 1.1.0
 * date: 2020-02-17 20:59:58
 * license: MIT
 */
!function(){var i=i||this||window||Function("return this")(),e=i.nx||require("@feizheng/next-js-core2"),r=require("@feizheng/next-file-upload"),o=require("@feizheng/next-weibo-to-pics"),s="/weibo_api/interface/pic_upload.php",u="https://tva1.sinaimg.cn",n=e.declare("nx.WeiboOss",{methods:{init:function(n,i){this._token=n,this._options=i,this.initToken()},initToken:function(){var n=this._token;"string"!=typeof this._token&&(n=this._token.find(function(n){return-1<n.indexOf("SUB=")})),i.document.cookie=n.split(";")[0]+"; Path=/;"},process:function(n,i,e){var t=JSON.parse(n.split("\n")[2]).data;0<t.count?i(o(t.pics).map(function(n){return n.type="g"===n.pid.charAt(21)?"gif":"jpg",n.url=[u,"/large/",n.pid,".",n.type].join(""),n})):e(n)},upload:function(n){var t=this;return new Promise(function(i,e){r(s,{pic1:n}).then(function(n){t.process(n,i,e)})})},uploads:function(n){var t=this,o={};return e.slice(n).forEach(function(n,i){o["pic"+(i+1)]=n}),new Promise(function(i,e){r(s,o).then(function(n){t.process(n,i,e)})})}}});"undefined"!=typeof module&&module.exports&&(module.exports=n)}();